# Windows 開機自動執行腳本設定說明

## 腳本檔案說明

此資料夾包含三個版本的自動重開機腳本：

1. **auto_restart.bat** - 基本版本
   - 簡單的批次腳本
   - 顯示倒數計時
   - 記錄執行時間

2. **auto_restart_advanced.bat** - 進階版本
   - 包含管理員權限檢查
   - 詳細的倒數計時顯示
   - 更完整的錯誤處理
   - 可按 Ctrl+C 取消

3. **auto_restart_silent.vbs** - 靜默版本
   - VBScript 版本
   - 背景執行，不顯示視窗
   - 適合完全自動化執行

## 設定方法

### 方法一：使用啟動資料夾（推薦）

1. 按 `Windows + R` 開啟執行對話框
2. 輸入 `shell:startup` 並按 Enter
3. 將選擇的腳本檔案複製到啟動資料夾中
4. 重開機測試

### 方法二：使用工作排程器（更靈活）

1. 按 `Windows + R`，輸入 `taskschd.msc`
2. 點選「建立基本工作」
3. 設定工作名稱：「自動重開機」
4. 觸發程序選擇：「當電腦啟動時」
5. 動作選擇：「啟動程式」
6. 程式路徑：選擇您要使用的腳本檔案
7. 在「條件」標籤中，取消勾選「只有在電腦使用 AC 電源時才啟動工作」
8. 在「設定」標籤中，勾選「允許工作隨選執行」

### 方法三：註冊表設定（進階用戶）

1. 按 `Windows + R`，輸入 `regedit`
2. 導航至：`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`
3. 右鍵新增「字串值」
4. 名稱：AutoRestart
5. 數值：腳本的完整路徑

## 安全注意事項

⚠️ **重要警告**：
- 此腳本會自動重開機，可能導致資料遺失
- 建議先在測試環境中驗證
- 確保已儲存所有重要工作
- 考慮在腳本中加入更長的延遲時間以供取消

## 自訂設定

### 修改等待時間
- 在 .bat 檔案中修改 `timeout /t 180` 中的數字（秒）
- 在 .vbs 檔案中修改 `WScript.Sleep(180000)` 中的數字（毫秒）

### 修改重開機訊息
- 修改 `shutdown` 命令中的 `/c` 參數後的訊息

### 停用腳本
- 從啟動資料夾移除檔案
- 或在工作排程器中停用工作
- 或刪除註冊表項目

## 疑難排解

**問題：腳本沒有執行**
- 檢查檔案路徑是否正確
- 確認檔案有執行權限
- 檢查防毒軟體是否阻擋

**問題：權限不足**
- 使用 `auto_restart_advanced.bat`，它會檢查管理員權限
- 或在工作排程器中設定「以最高權限執行」

**問題：想要取消自動重開機**
- 使用 `shutdown /a` 命令可以取消預定的重開機
- 或重新啟動 Windows 服務

## 記錄檔位置

所有腳本都會在以下位置建立記錄檔：
- `C:\Windows\Temp\auto_restart_log.txt` （.bat 版本）
- `C:\Windows\Temp\auto_restart_vbs_log.txt` （.vbs 版本）

建立日期：2025年7月21日
